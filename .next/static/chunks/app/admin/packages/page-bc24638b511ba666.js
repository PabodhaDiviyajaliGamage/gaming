(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[181],{568:function(e,a,t){Promise.resolve().then(t.bind(t,5279))},5279:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return n}});var l=t(7437),s=t(2265),r=t(2617);function n(){let[e,a]=(0,s.useState)([]),[t,n]=(0,s.useState)([]),[d,c]=(0,s.useState)(!1),[i,o]=(0,s.useState)(null),[m,g]=(0,s.useState)("all"),[u,x]=(0,s.useState)(!1),[p,b]=(0,s.useState)({gameId:"",gameName:"",amount:"",price:"",image:"",popular:!1,status:"active"});(0,s.useEffect)(()=>{f(),h()},[]);let h=async()=>{try{let e=await r._W.getAll();n(e.data||[])}catch(e){console.error("Error loading games:",e)}},f=async()=>{try{x(!0);let e=await r.Pc.getAll();a(e.data||[])}catch(e){console.error("Error loading packages:",e),alert("Failed to load packages: "+e.message)}finally{x(!1)}},y=e=>{o(e),b(e),c(!0)},N=async e=>{if(confirm("Are you sure you want to delete this package?"))try{x(!0),await r.Pc.delete(e),alert("Package deleted successfully!"),f()}catch(e){console.error("Error deleting package:",e),alert("Failed to delete package: "+e.message)}finally{x(!1)}},j=async e=>{e.preventDefault();try{x(!0),i?(await r.Pc.update(i._id,p),alert("Package updated successfully!")):(await r.Pc.create(p),alert("Package added successfully!")),c(!1),f()}catch(e){console.error("Error saving package:",e),alert("Failed to save package: "+e.message)}finally{x(!1)}};e.reduce((e,a)=>{let t=a.gameName||a.game;return e[t]||(e[t]=[]),e[t].push(a),e},{});let v=("all"===m?e:e.filter(e=>(e.gameName||e.game)===m)).reduce((e,a)=>{let t=a.gameName||a.game;return e[t]||(e[t]=[]),e[t].push(a),e},{}),k=[...new Set(e.map(e=>e.gameName||e.game))];return(0,l.jsxs)("div",{className:"text-white flex gap-6",children:[(0,l.jsxs)("div",{className:"w-64 bg-gray-800 rounded-lg p-6 h-fit sticky top-6",children:[(0,l.jsx)("button",{onClick:()=>{o(null),b({gameId:"",gameName:"",amount:"",price:"",image:"",popular:!1,status:"active"}),c(!0)},className:"w-full px-6 py-3 bg-green-600 hover:bg-green-700 rounded-lg font-semibold transition mb-6",children:"+ Add New Package"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-gray-400 mb-3",children:"FILTER BY GAME"}),(0,l.jsxs)("button",{onClick:()=>g("all"),className:"w-full text-left px-4 py-2 rounded-lg transition ".concat("all"===m?"bg-blue-600 text-white":"bg-gray-700 hover:bg-gray-600"),children:["All Games (",e.length,")"]}),k.map(a=>(0,l.jsxs)("button",{onClick:()=>g(a),className:"w-full text-left px-4 py-2 rounded-lg transition ".concat(m===a?"bg-blue-600 text-white":"bg-gray-700 hover:bg-gray-600"),children:[a," (",e.filter(e=>(e.gameName||e.game)===a).length,")"]},a))]})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Packages Management"}),0===Object.keys(v).length?(0,l.jsx)("div",{className:"bg-gray-800 rounded-lg p-8 text-center text-gray-400",children:'No packages found. Click "Add New Package" to create one.'}):Object.entries(v).map(e=>{let[a,t]=e;return(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4 text-yellow-400",children:a}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t.map(e=>(0,l.jsxs)("div",{className:"bg-gray-800 border-2 ".concat(e.popular?"border-yellow-500":"border-gray-700"," rounded-lg p-6 relative"),children:[e.popular&&(0,l.jsx)("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 bg-yellow-500 text-black text-xs font-bold px-3 py-1 rounded-full",children:"POPULAR"}),(0,l.jsxs)("div",{className:"text-center mb-4",children:[e.image?(0,l.jsx)("img",{src:e.image,alt:e.amount||e.name,className:"w-24 h-24 mx-auto mb-3 object-contain rounded-lg"}):(0,l.jsx)("div",{className:"w-24 h-24 mx-auto mb-3 bg-gray-700 rounded-lg flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-gray-500 text-sm",children:"No Image"})}),(0,l.jsx)("h3",{className:"text-xl font-bold mb-1",children:e.amount||e.name}),(0,l.jsx)("p",{className:"text-2xl font-bold text-yellow-400 mt-2",children:e.price})]}),(0,l.jsx)("div",{className:"mb-3",children:(0,l.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat("active"===e.status?"bg-green-500":"bg-red-500"),children:e.status.toUpperCase()})}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>y(e),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 rounded text-sm transition",disabled:u,children:"Edit"}),(0,l.jsx)("button",{onClick:()=>N(e._id||e.id),className:"flex-1 px-3 py-2 bg-red-600 hover:bg-red-700 rounded text-sm transition",disabled:u,children:"Delete"})]})]},e._id||e.id))})]},a)})]}),d&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-gray-800 rounded-xl max-w-md w-full p-6",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4",children:i?"Edit Package":"Add New Package"}),(0,l.jsxs)("form",{onSubmit:j,children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Game *"}),(0,l.jsxs)("select",{value:p.gameId,onChange:e=>{let a=t.find(a=>a._id===e.target.value);b({...p,gameId:e.target.value,gameName:a?a.name:""})},className:"w-full px-4 py-2 rounded bg-gray-700 border border-gray-600",required:!0,children:[(0,l.jsx)("option",{value:"",children:"Select Game"}),t.map(e=>(0,l.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Package Amount *"}),(0,l.jsx)("input",{type:"text",value:p.amount,onChange:e=>b({...p,amount:e.target.value}),className:"w-full px-4 py-2 rounded bg-gray-700 border border-gray-600",placeholder:"e.g., 310 Diamonds",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Price *"}),(0,l.jsx)("input",{type:"text",value:p.price,onChange:e=>b({...p,price:e.target.value}),className:"w-full px-4 py-2 rounded bg-gray-700 border border-gray-600",placeholder:"e.g., LKR 500",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Package Image *"}),(0,l.jsx)("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:e=>{let a=e.target.files[0];if(a){let e=new FileReader;e.onloadend=()=>{b({...p,image:e.result})},e.readAsDataURL(a)}},className:"w-full px-4 py-2 rounded bg-gray-700 border border-gray-600 text-sm file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700",required:!p.image}),(0,l.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Upload PNG, JPG, or WebP image (recommended: 256x256px)"}),p.image&&(0,l.jsxs)("div",{className:"mt-2 p-2 bg-gray-700 rounded",children:[(0,l.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Preview:"}),(0,l.jsx)("img",{src:p.image,alt:"Preview",className:"w-16 h-16 object-contain rounded"}),(0,l.jsx)("button",{type:"button",onClick:()=>b({...p,image:""}),className:"text-xs text-red-400 mt-1 hover:text-red-300",children:"Remove Image"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"checkbox",id:"popular",checked:p.popular,onChange:e=>b({...p,popular:e.target.checked}),className:"w-4 h-4"}),(0,l.jsx)("label",{htmlFor:"popular",className:"text-sm font-medium",children:"Mark as Popular"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Status *"}),(0,l.jsxs)("select",{value:p.status,onChange:e=>b({...p,status:e.target.value}),className:"w-full px-4 py-2 rounded bg-gray-700 border border-gray-600",required:!0,children:[(0,l.jsx)("option",{value:"active",children:"Active"}),(0,l.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]}),(0,l.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,l.jsx)("button",{type:"submit",className:"flex-1 px-6 py-3 bg-green-600 hover:bg-green-700 rounded-lg font-semibold transition",children:i?"Update":"Add"}),(0,l.jsx)("button",{type:"button",onClick:()=>c(!1),className:"flex-1 px-6 py-3 bg-red-600 hover:bg-red-700 rounded-lg font-semibold transition",children:"Cancel"})]})]})]})})]})}},2617:function(e,a,t){"use strict";async function l(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=await fetch("".concat("/api").concat(e),{headers:{"Content-Type":"application/json",...a.headers},...a}),l=await t.json();if(!t.ok)throw Error(l.error||"API request failed");return l}t.d(a,{Pc:function(){return r},_W:function(){return s},g3:function(){return n},h3:function(){return d}});let s={getAll:()=>l("/games"),getById:e=>l("/games/".concat(e)),create:e=>l("/games",{method:"POST",body:JSON.stringify(e)}),update:(e,a)=>l("/games/".concat(e),{method:"PUT",body:JSON.stringify(a)}),delete:e=>l("/games/".concat(e),{method:"DELETE"})},r={getAll:()=>l("/packages"),getById:e=>l("/packages/".concat(e)),create:e=>l("/packages",{method:"POST",body:JSON.stringify(e)}),update:(e,a)=>l("/packages/".concat(e),{method:"PUT",body:JSON.stringify(a)}),delete:e=>l("/packages/".concat(e),{method:"DELETE"})},n={getAll:()=>l("/orders"),getById:e=>l("/orders/".concat(e)),create:e=>l("/orders",{method:"POST",body:JSON.stringify(e)}),update:(e,a)=>l("/orders/".concat(e),{method:"PUT",body:JSON.stringify(a)}),delete:e=>l("/orders/".concat(e),{method:"DELETE"})},d={getAll:()=>l("/users"),register:e=>l("/users",{method:"POST",body:JSON.stringify(e)}),update:(e,a)=>l("/users/".concat(e),{method:"PUT",body:JSON.stringify(a)}),delete:e=>l("/users/".concat(e),{method:"DELETE"}),login:e=>l("/auth/login",{method:"POST",body:JSON.stringify(e)})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=568)}),_N_E=e.O()}]);