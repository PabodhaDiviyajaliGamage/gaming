(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[928],{9593:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Admin_Dashbord/Orders",function(){return s(8471)}])},9703:function(e,t){"use strict";t.Z={src:"/_next/static/media/WhatsApp.23140897.png",height:1850,width:1850,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAA00lEQVR42mMAAY+r4YwFG6oZJ7yaKsAABZGPUpkY0IHpPS+tuMeZUQZPXBVA/LCniUwMEx9MZ2JYysCYeC23aPaTBWdXvFrzf9qr2ZeNHrspwXWqn3Cqn3B72v+Dr4/8T7qV+2vhi6X/J7ycOgmuwOqo786JN6b9X/pg5fc1Tzf8Wvx0xf/+J1POM6xnYGMAg3UM2n1Xpvyfd2fR/1UP1/1f+mjl/+gb6ZsZQKD1ag8jiPY5HLU4/0zF/Y5r/cUu50PDXS+EqTJgADOQkQigd9GNEQAb+lzO5L7W1gAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},2603:function(e,t,s){"use strict";s.d(t,{Hz:function(){return n}});var a=s(3454);let r=a.env.NEXT_PUBLIC_API_URL||"/api",n={API_BASE_URL:r,API_ENDPOINTS:{auth:{login:"".concat(r,"/auth/login"),register:"".concat(r,"/auth/register"),logout:"".concat(r,"/auth/logout"),verify:"".concat(r,"/auth/verify")},users:"".concat(r,"/users"),games:"".concat(r,"/games"),packages:"".concat(r,"/packages"),orders:"".concat(r,"/orders")},LOGGING_ENABLED:"true"===a.env.VITE_API_LOGGING}},8471:function(e,t,s){"use strict";s.r(t);var a=s(5893),r=s(7294),n=s(7066),o=s(1379),l=s(2771),i=s(1606),c=s(9703),d=s(8808),m=s(2603);t.default=()=>{let[e,t]=(0,r.useState)([]),[s,g]=(0,r.useState)(""),[u,p]=(0,r.useState)(!0),[h,x]=(0,r.useState)(""),[b,f]=(0,r.useState)(null),[N,v]=(0,r.useState)("email"),[y,w]=(0,r.useState)(""),[j,A]=(0,r.useState)(""),[I,D]=(0,r.useState)(!1),[k,S]=(0,r.useState)({success:!1,message:""}),[E,L]=(0,r.useState)(null),[P,C]=(0,r.useState)(!1),{orderId:U}=(0,o.UO)();(0,r.useEffect)(()=>{p(!0),x(""),(async()=>{try{let e=localStorage.getItem("token");if(e){let s=(await n.Z.get((0,d.kG)("/api/order"),{headers:{Authorization:"Bearer ".concat(e)}})).data.map(e=>{var t,s;let a=e.userId||{},r=e.packageId||{},n=r.gameId||{};return{orderId:e._id,orderNumber:e._id.substring(0,8),game:n.gamename||"Unknown Game",userId:(null===(t=e.userId)||void 0===t?void 0:t._id)||e.userId,playerName:e.playerName,playerId:e.playerId,packageId:(null===(s=e.packageId)||void 0===s?void 0:s._id)||e.packageId,packageName:r.packagename||"Unknown Package",totalPrice:e.totalPrice,date:new Date(e.date).toLocaleString(),receiptImage:e.recipt,status:e.status,email:a.email||e.email,phone:a.phone||e.phone,mongoDbId:e._id}});t(s)}else t([]),x("Authentication required. Please log in to view orders.");p(!1)}catch(e){console.error("Error fetching orders:",e),t([]),x("Failed to load orders from server. Please try again later."),p(!1)}})()},[U]);let M=e.filter(e=>Object.values(e).some(e=>String(e).toLowerCase().includes(s.toLowerCase()))),R=(s,a,r)=>{if(r===a)return;t(e.map(e=>e.orderId===s?{...e,status:a}:e));let o=localStorage.getItem("token");o&&n.Z.patch("".concat((0,d.kG)("/api/order/status"),"/").concat(s),{status:a},{headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"}}).then(e=>{console.log("Status updated on server:",e.data),"completed"===a&&(S({success:!0,message:"Order marked as completed. A confirmation email has been sent to the customer."}),setTimeout(()=>{S({success:!1,message:""})},5e3))}).catch(e=>{console.error("Error updating status on server:",e),x("Failed to update order status on server. Please try again."),setTimeout(()=>x(""),3e3)})},G=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"email";f(e),v(t),"email"===t?(w("Update on your order ".concat(e.orderNumber||e.orderId)),A("Dear ".concat(e.playerName||"Customer",",\n\nYour order for ").concat(e.packageName," in ").concat(e.game," has been processed. Your account with Player ID ").concat(e.playerId||"[Player ID]"," will be credited within the next few hours.\n\nThank you for choosing SL Gaming Hub!\n\nBest regards,\nSL Gaming Hub Team"))):A("*Update on your SL Gaming Hub order*\n\nDear ".concat(e.playerName||"Customer",",\n\nYour order for ").concat(e.packageName," in ").concat(e.game," has been processed. Your account with Player ID *").concat(e.playerId||"[Player ID]","* will be credited within the next few hours.\n\nThank you for choosing SL Gaming Hub!\n\nBest regards,\nSL Gaming Hub Team"))},O=e=>{if(!e||!e.phone)return"#";let t="Hello! I'm from SL Gaming Hub regarding your order ".concat(e.orderNumber||e.orderId,". How can I help you?");return(0,i.lY)(e.phone,t)},T=e=>{let t=e.recipt||e.receiptImage;if(!t){alert("No receipt image available for this order.");return}let s=m.Hz.BASE_URL.replace("/api","");t.startsWith("http")?console.log("Using existing full URL:",t):t.startsWith("/uploads/")?(console.log("Converting /uploads/ path to full URL"),t="".concat(s).concat(t)):t.startsWith("data:")?console.log("Using data URL as is"):(console.log("Treating as a filename, adding full path"),t="".concat(s,"/uploads/").concat(t)),console.log("Displaying receipt image:",t),L(t),C(!0)},B=async s=>{if(s.preventDefault(),!b){S({success:!1,message:"No order selected"});return}if("email"===N&&!b.email){S({success:!1,message:"No email address found for this customer"});return}if("whatsapp"===N&&!b.phone){S({success:!1,message:"No phone number found for this customer"});return}D(!0),S({success:!1,message:""});try{if("email"===N){await (0,l.Cz)({to:b.email,subject:y,body:j,from:"orders@16.170.236.106"});let s=e.map(e=>e.orderId===b.orderId?{...e,emailsSent:[...e.emailsSent||[],{subject:y,timestamp:new Date().toISOString()}]}:e);t(s),localStorage.setItem("completedOrders",JSON.stringify(s)),S({success:!0,message:"Email sent successfully to ".concat(b.email)})}else{await (0,i.U3)({to:b.phone,message:j});let s=e.map(e=>e.orderId===b.orderId?{...e,whatsappSent:[...e.whatsappSent||[],{timestamp:new Date().toISOString()}]}:e);t(s),localStorage.setItem("completedOrders",JSON.stringify(s)),S({success:!0,message:"WhatsApp message sent successfully to ".concat(b.phone)})}setTimeout(()=>{f(null)},2e3)}catch(e){S({success:!1,message:"Failed to send ".concat(N,": ").concat(e.message)})}finally{D(!1)}};return(0,a.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Orders"}),(0,a.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-500 text-blue-700 p-4 mb-4 rounded",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("p",{className:"text-sm",children:"This page now shows only server-stored orders. Locally stored orders are no longer displayed."})})]})}),(0,a.jsx)("input",{type:"text",placeholder:"Search by Order ID, User, Player...",value:s,onChange:e=>g(e.target.value),className:"border p-2 mb-4 w-full sm:w-[300px] rounded"}),u?(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("p",{children:"Loading orders..."})}):h?(0,a.jsx)("div",{className:"text-center py-4 text-red-500",children:(0,a.jsx)("p",{children:h})}):0===M.length?(0,a.jsx)("p",{children:"No orders found."}):(0,a.jsx)("div",{className:"grid gap-4",children:M.map((s,r)=>(0,a.jsxs)("div",{className:"bg-gray-100 rounded shadow p-4 flex flex-col sm:flex-row sm:items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsxs)("div",{className:"font-bold text-lg mb-2",children:["Order ID: ",s.orderNumber||s.orderId]}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:["Game: ",s.game]}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:["User ID: ",s.userId]}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:["Player Name: ",s.playerName]}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:["Player ID: ",s.playerId]}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:["Package Name: ",s.packageName]}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:["Total Price: ",s.totalPrice]}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:["Date: ",s.date]}),s.email&&(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"Customer Email:"})," ",s.email]}),s.phone&&(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"Customer Phone:"})," ",s.phone,(0,a.jsxs)("a",{href:O(s),target:"_blank",rel:"noopener noreferrer",className:"ml-2 inline-flex items-center text-green-600 hover:text-green-700",children:[(0,a.jsx)("img",{src:c.Z,alt:"WhatsApp",className:"h-4 w-4"}),(0,a.jsx)("span",{className:"ml-1 text-xs",children:"Chat"})]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"Status:"}),(0,a.jsxs)("select",{value:s.status||"pending",onChange:e=>R(s.orderId,e.target.value,s.status),className:"ml-2 px-2 py-1 border rounded",children:[(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"processing",children:"Processing"}),(0,a.jsx)("option",{value:"completed",children:"Completed"}),(0,a.jsx)("option",{value:"canceled",children:"Canceled"}),(0,a.jsx)("option",{value:"rejected",children:"Rejected"})]}),s.mongoDbId&&(0,a.jsxs)("span",{className:"ml-2 text-xs text-blue-500",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Server synced"]})]}),s.emailsSent&&s.emailsSent.length>0&&(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"Emails Sent:"})," ",s.emailsSent.length,(0,a.jsxs)("ul",{className:"text-xs ml-4",children:[s.emailsSent.slice(0,2).map((e,t)=>(0,a.jsxs)("li",{className:"italic",children:[new Date(e.timestamp).toLocaleString(),': "',e.subject,'"']},t)),s.emailsSent.length>2&&(0,a.jsx)("li",{children:"..."})]})]}),s.whatsappSent&&s.whatsappSent.length>0&&(0,a.jsxs)("div",{className:"text-sm text-gray-700 mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"WhatsApp Sent:"})," ",s.whatsappSent.length,(0,a.jsxs)("ul",{className:"text-xs ml-4",children:[s.whatsappSent.slice(0,2).map((e,t)=>(0,a.jsx)("li",{className:"italic",children:new Date(e.timestamp).toLocaleString()},t)),s.whatsappSent.length>2&&(0,a.jsx)("li",{children:"..."})]})]})]}),(0,a.jsxs)("div",{className:"sm:ml-4 mt-4 sm:mt-0 flex flex-col gap-2",children:[s.email&&(0,a.jsxs)("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm flex items-center justify-center",onClick:()=>G(s,"email"),children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Send Email"]}),s.phone&&(0,a.jsxs)("button",{className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm flex items-center justify-center",onClick:()=>G(s,"whatsapp"),children:[(0,a.jsx)("img",{src:c.Z,alt:"WhatsApp",className:"h-4 w-4 mr-1"}),"Send WhatsApp"]}),(s.receiptImage||s.recipt)&&(0,a.jsxs)("button",{className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded text-sm flex items-center justify-center",onClick:()=>T(s),children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"View Receipt"]}),(0,a.jsx)("button",{className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded text-sm",onClick:()=>{if(window.confirm("Are you sure you want to delete this order?")){t(e.filter(e=>e.orderId!==s.orderId));let a=localStorage.getItem("token");a&&n.Z.delete("".concat((0,d.kG)("/api/order"),"/").concat(s.orderId),{headers:{Authorization:"Bearer ".concat(a)}}).then(e=>{console.log("Order deleted from server:",e.data)}).catch(e=>{console.error("Error deleting order from server:",e),x("Failed to delete order from server. Please try again."),setTimeout(()=>x(""),3e3)})}},children:"Delete"})]})]},s.orderId||r))}),b&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-2xl",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:"email"===N?"Send Email to Customer":"Send WhatsApp to Customer"}),(0,a.jsx)("button",{onClick:()=>f(null),className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex mb-3",children:[(0,a.jsxs)("button",{onClick:()=>v("email"),className:"flex-1 py-2 flex items-center justify-center ".concat("email"===N?"bg-blue-100 border-b-2 border-blue-500 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]}),(0,a.jsxs)("button",{onClick:()=>v("whatsapp"),className:"flex-1 py-2 flex items-center justify-center ".concat("whatsapp"===N?"bg-green-100 border-b-2 border-green-500 text-green-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,a.jsx)("img",{src:c.Z,alt:"WhatsApp",className:"h-5 w-5 mr-1"}),"WhatsApp"]})]}),"email"===N?(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium",children:"To:"})," ",b.email||"No email available"]}):(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium",children:"To:"})," ",b.phone||"No phone number available"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium",children:"Customer:"})," ",b.playerName||"N/A"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium",children:"Player ID:"})," ",b.playerId||"N/A"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium",children:"Order:"})," ",b.orderNumber||b.orderId]})]}),(0,a.jsxs)("form",{onSubmit:B,children:["email"===N&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"emailSubject",className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),(0,a.jsx)("input",{type:"text",id:"emailSubject",value:y,onChange:e=>w(e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",required:!0})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("label",{htmlFor:"messageBody",className:"block text-sm font-medium text-gray-700",children:"Message"}),(0,a.jsxs)("select",{className:"text-xs border border-gray-300 rounded px-2 py-1",onChange:e=>{e.target.value&&A(e.target.value.replace("[PLAYER_NAME]",b.playerName||"Customer").replace("[PLAYER_ID]",b.playerId||"Unknown").replace("[ORDER_ID]",b.orderNumber||b.orderId).replace("[GAME]",b.game||"your game").replace("[PACKAGE]",b.packageName||"your package"))},children:[(0,a.jsx)("option",{value:"",children:"Select Template"}),(0,a.jsx)("option",{value:"Dear [PLAYER_NAME],\\n\\nWe're following up on your order #[ORDER_ID].\\n\\nWe notice your Player ID is [PLAYER_ID]. Is this correct?\\n\\nThank you,\\nSL Gaming Hub Team",children:"Player ID Confirmation"}),(0,a.jsx)("option",{value:"Dear [PLAYER_NAME],\\n\\nYour order #[ORDER_ID] has been completed and credited to your account with Player ID [PLAYER_ID].\\n\\nThank you for your purchase!\\n\\nSL Gaming Hub Team",children:"Order Completion"}),(0,a.jsx)("option",{value:"Dear [PLAYER_NAME],\\n\\nWe need additional information for your [GAME] order #[ORDER_ID].\\n\\nCould you please confirm your Player ID: [PLAYER_ID]?\\n\\nThank you,\\nSL Gaming Hub Team",children:"Request Player ID Confirmation"})]})]}),(0,a.jsx)("textarea",{id:"messageBody",value:j,onChange:e=>A(e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 h-40",required:!0}),"whatsapp"===N&&(0,a.jsxs)("p",{className:"mt-1 text-xs text-gray-500",children:[(0,a.jsx)("strong",{children:"Tip:"})," Use *asterisks* for bold text, _underscores_ for italic text"]})]}),k.message&&(0,a.jsx)("div",{className:"mb-4 p-3 rounded ".concat(k.success?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:k.message}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>f(null),className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded",disabled:I,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 ".concat("email"===N?"bg-blue-600 hover:bg-blue-700":"bg-green-600 hover:bg-green-700"," text-white rounded flex items-center"),disabled:I||"email"===N&&!b.email||"whatsapp"===N&&!b.phone,children:I?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending..."]}):"email"===N?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Send Email"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{src:c.Z,alt:"WhatsApp",className:"h-4 w-4 mr-1"}),"Send WhatsApp"]})})]})]})]})}),P&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-2xl",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:"Bank Receipt"}),(0,a.jsx)("button",{onClick:()=>C(!1),className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(void 0).DEV&&(0,a.jsxs)("div",{className:"mb-4 p-2 bg-gray-100 rounded text-xs overflow-auto max-h-20",children:[(0,a.jsx)("strong",{children:"Image URL:"})," ",E]}),(0,a.jsx)("div",{className:"flex justify-center",children:E?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:E,alt:"Bank Receipt",className:"max-w-full max-h-[70vh] object-contain",onError:e=>{console.error("Failed to load image:",E),e.target.onerror=null,e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIGZpbGw9IiNFNUU3RUIiLz48cGF0aCBkPSJNNDAgNTBINjBNNTAgNDBWNjAiIHN0cm9rZT0iIzZCN0NCRCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz48L3N2Zz4=";let t=E.includes("/api/")?E.replace("/api/","/"):E.replace("/uploads/","/api/uploads/");if(t!==E){console.log("Trying alternative URL:",t);let s=new Image;s.onload=()=>{console.log("Alternative URL worked, updating image"),e.target.src=t},s.onerror=()=>{console.error("Alternative URL also failed"),alert("Error loading the receipt image. The image might be corrupted or unavailable.")},s.src=t}else alert("Error loading the receipt image. The image might be corrupted or unavailable.")}}),(0,a.jsxs)("div",{className:"absolute bottom-2 right-2 flex gap-2",children:[(0,a.jsxs)("a",{href:E,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-full text-xs flex items-center",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Open Original"]}),(0,a.jsxs)("a",{href:E,download:"bank-receipt.jpg",className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded-full text-xs flex items-center",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]})]})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center p-10 border-2 border-dashed border-gray-300 rounded-lg",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-gray-400 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,a.jsx)("p",{className:"text-gray-500",children:"Receipt image could not be loaded"})]})}),(0,a.jsxs)("div",{className:"mt-4 flex justify-center space-x-3",children:[(0,a.jsx)("button",{onClick:()=>C(!1),className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded",children:"Close"}),E&&(0,a.jsxs)("a",{href:E,download:"receipt.jpg",className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded flex items-center",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]})]})]})})]})}},8808:function(e,t,s){"use strict";s.d(t,{NU:function(){return n},kG:function(){return r}});let a=s(3454).env.NEXT_PUBLIC_API_URL||"/api",r=e=>{let t=e.startsWith("/")?e.slice(1):e;return"".concat(a,"/").concat(t)},n=e=>{let t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t}},2771:function(e,t,s){"use strict";s.d(t,{Cz:function(){return a},it:function(){return r}});let a=e=>new Promise((t,s)=>{try{if(!e.to||!e.subject||!e.body){let t=Error("Missing required email fields (to, subject, body)");throw console.error("Email validation failed:",t,e),t}console.log("EMAIL DEBUG - Sending email to:",e.to),console.log("EMAIL DEBUG - Subject:",e.subject),console.log("EMAIL DEBUG - Body length:",e.body.length,"characters");try{let t=JSON.parse(localStorage.getItem("sentEmails")||"[]");t.push({to:e.to,subject:e.subject,from:e.from||"system@16.170.236.106",timestamp:new Date().toISOString(),status:"sent"}),localStorage.setItem("sentEmails",JSON.stringify(t)),console.log("EMAIL DEBUG - Saved to localStorage successfully")}catch(e){console.error("EMAIL DEBUG - Failed to save to localStorage:",e)}setTimeout(()=>{console.log("EMAIL DEBUG - Email sent successfully to:",e.to),t({success:!0,message:"Email sent successfully"})},1e3)}catch(e){console.error("Email sending failed:",e),s(e)}}),r=e=>{console.log("EMAIL DEBUG - sendOrderNotificationToAdmin called"),console.log("EMAIL DEBUG - Order details:",JSON.stringify(e));let t="admin@16.170.236.106",s="New Order Received - ".concat(e.orderNumber||e.orderId||"New Order"),r='\n    <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">\n      <div style="background-color: #0e08ab; color: white; padding: 20px; text-align: center;">\n        <h1 style="margin: 0;">New Order Received</h1>\n      </div>\n      \n      <div style="padding: 20px; border: 1px solid #ddd; background-color: #f9f9f9;">\n        <p>A new order has been received and is ready for processing:</p>\n        \n        <div style="background-color: #fff; border: 1px solid #eee; padding: 15px; margin: 15px 0;">\n          <h2 style="margin-top: 0; color: #0e08ab;">Order Details</h2>\n          <p><strong>Order Number:</strong> '.concat(e.orderNumber||e.orderId||"New Order","</p>\n          <p><strong>Date:</strong> ").concat(new Date().toLocaleString(),"</p>\n          <p><strong>Game:</strong> ").concat(e.gameName||e.game||"","</p>\n          <p><strong>Package:</strong> ").concat(e.packageName||"","</p>\n          <p><strong>Amount:</strong> ").concat(e.packagePrice||e.totalPrice||"","</p>\n          <p><strong>Game ID:</strong> ").concat(e.userId||"","</p>\n          <p><strong>Username:</strong> ").concat(e.username||e.playerName||"","</p>\n          \n          ").concat(e.receiptImage?"<p><strong>Payment Receipt:</strong> Uploaded</p>":"","\n          \n          <p><strong>Customer Email:</strong> ").concat(e.email||"Not provided",'</p>\n          <p><strong>Status:</strong> <span style="color: orange; font-weight: bold;">Pending</span></p>\n        </div>\n        \n        <p>Please log in to the admin dashboard to process this order.</p>\n      </div>\n      \n      <div style="padding: 20px; text-align: center; font-size: 12px; color: #777;">\n        <p>This is an automated notification from the SL Gaming Hub system.</p>\n        <p>&copy; ').concat(new Date().getFullYear()," SL Gaming Hub. All rights reserved.</p>\n      </div>\n    </div>\n  ");return console.log("EMAIL DEBUG - Prepared admin email to:",t),a({to:t,subject:s,body:r,from:"system@16.170.236.106"})}},1606:function(e,t,s){"use strict";s.d(t,{Mp:function(){return n},U3:function(){return a},lY:function(){return o}});let a=e=>new Promise((t,s)=>{try{if(!e.to||!e.message){let t=Error("Missing required WhatsApp fields (to, message)");throw console.error("WhatsApp validation failed:",t,e),t}let s=r(e.to);console.log("WHATSAPP DEBUG - Sending message to:",s),console.log("WHATSAPP DEBUG - Message:",e.message.substring(0,100)+"...");try{let t=JSON.parse(localStorage.getItem("sentWhatsAppMessages")||"[]");t.push({to:s,message:e.message,timestamp:new Date().toISOString(),status:"sent"}),localStorage.setItem("sentWhatsAppMessages",JSON.stringify(t)),console.log("WHATSAPP DEBUG - Saved to localStorage successfully")}catch(e){console.error("WHATSAPP DEBUG - Failed to save to localStorage:",e)}setTimeout(()=>{console.log("WHATSAPP DEBUG - WhatsApp message sent successfully to:",s),t({success:!0,message:"WhatsApp message sent successfully"})},1e3)}catch(e){console.error("WhatsApp sending failed:",e),s(e)}}),r=e=>{let t=e.replace(/\D/g,"");return 9===t.length?t="94"+t:10===t.length&&t.startsWith("0")&&(t="94"+t.substring(1)),t},n=e=>{console.log("WHATSAPP DEBUG - sendOrderNotificationToAdmin called");let t="+94771234567",s="\n*SL GAMING HUB - NEW ORDER ALERT*\n\nA new order has been received and requires processing.\n\n*ORDER INFORMATION*\n\uD83D\uDCCB Order Number: ".concat(e.orderNumber||e.orderId||"New Order","\n\uD83D\uDCC6 Order Date: ").concat(new Date().toLocaleString(),"\n⏳ Status: Payment Received - Awaiting Processing\n\n*CUSTOMER INFORMATION*\n\uD83D\uDC64 Customer Name: ").concat(e.username||e.playerName||"Not provided","\n� WhatsApp: ").concat(e.phone||"Not provided","\n\uD83C\uDD94 Game ID: ").concat(e.userId||"Not provided","\n\n*PURCHASE DETAILS*\n\uD83C\uDFAE Game: ").concat(e.gameName||e.game||"","\n\uD83D\uDCE6 Package: ").concat(e.packageName||"","\n").concat(e.packageDescription?"\uD83D\uDCDD Description: ".concat(e.packageDescription,"\n"):"","\n� Amount: ").concat(e.packagePrice||e.totalPrice||"","\n\uD83D\uDCB3 Payment Method: Bank Transfer\n✅ Payment Status: Received\n\n*REQUIRED ACTIONS*\n1. Verify payment details\n2. Process the order in the game system\n3. Update order status in dashboard\n4. Mark as completed when done\n\nPlease login to the admin dashboard to process this order:\n\uD83C\uDF10 Admin URL: http://16.170.236.106/admin/orders\n\nIMPORTANT: This order requires immediate attention.\n  ");return console.log("WHATSAPP DEBUG - Prepared admin WhatsApp message to:",t),a({to:t,message:s})},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=r(e),a=encodeURIComponent(t);return"https://wa.me/".concat(s,"?text=").concat(a)}}},function(e){e.O(0,[435,66,888,774,179],function(){return e(e.s=9593)}),_N_E=e.O()}]);